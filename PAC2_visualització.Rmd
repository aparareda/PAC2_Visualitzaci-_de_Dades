---
title: "PAC2"
author: "Aina Parareda Casablancas"
date: "MarÃ§ 2025"
output:
  ioslides_presentation: default
  slidy_presentation: default
subtitle: UOC - VisualitzaciÃ³ de Dades - Aula 1
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

## ğŸŒŸ IntroducciÃ³

Per a realitzar aquesta presentaciÃ³ he utilitzat **RStudio** amb l'eina de **RMarkdown** per a generar una presentaciÃ³ en **HTML (ioslides)**.

Aquesta presentaciÃ³ contÃ© una explicaciÃ³ i exemples de diferents tÃ¨cniques de visualitzaciÃ³ de dades:

- ğŸ”¥ **Heatmap**  
- ğŸ“Š **Radar Charts**  
- ğŸ“ˆ **Ridgeline Charts**  

El codi i els recursos es poden trobar en el segÃ¼ent repositori de GitHub:  
ğŸ”— [PAC2_VisualitzaciÃ³_de_Dades](https://github.com/aparareda/PAC2_Visualitzaci-_de_Dades)  

## ğŸŒŸ Requisits previs

Abans d'executar la presentaciÃ³, m'asseguro de tenir instalÂ·lades les llibreries necessÃ ries per a R:

```{r check_packages, echo=FALSE}
packages <- c("ggplot2", "reshape2", "readr", "ggridges", "tibble", "dplyr", "fmsb")

# Comprovo les llibreries instalÂ·lades
installed_packages <- installed.packages()[,"Package"]

# Mostro les llibreries 
for (pkg in packages) {
  cat(paste("- ", pkg, "\n"))
}

# InstalÂ·lo les que falten
new_packages <- packages[!(packages %in% installed_packages)]
if(length(new_packages)) install.packages(new_packages)


```

## ğŸ“œ Bibliografia

Per a conÃ¨ixer i veure exemples de les grÃ fiques i el codi per a realitzar-les he utilitzat les segÃ¼ents webs:

-   Data to Viz: <https://www.data-to-viz.com>
-   DataViz Project: <https://datavizproject.com>
-   CatÃ leg de VisualitzaciÃ³ de Dades: <https://datavizcatalogue.com/ES>

## ğŸ”¥ Heatmap

-   RepresentaciÃ³ de dades en una **matriu** mitjanÃ§ant variacions de **color**.
-   Ãštil per identificar **patrons, correlacions i relacions** entre variables.
-   Proporciona una **visiÃ³ general** de les dades numÃ¨riques.

**ğŸ“œ Origen i Autoria**

-   El terme *Heat map* va ser introduÃ¯t per **Cormac Kinney (1991)** per visualitzar dades financeres en temps real.
-   Visualitzacions similars ja existien **fa mÃ©s d'un segle**.

## ğŸ—ï¸ Estructura d'un Heatmap

-   **Files:** Representen una categoria (etiquetes a l'esquerra o dreta).
-   **Columnes:** Representen una altra categoria (etiquetes a la part superior o inferior).
-   **Celdes:** Contenen dades codificades per color:
    -   **Dades categÃ²riques:** Colors fixes.
    -   **Dades numÃ¨riques:** Escala de colors.

**ğŸ¨ ImportÃ ncia de la Llegenda**

-   Els *Heatmaps* requereixen **una llegenda** per interpretar-los correctament.
-   Escales de color:
    -   **Colors sÃ²lids:** Intervals (0-10, 11-20, etc.).
    -   **Escales en gradient:** Valors continus (ex: de 0 a 100).

**ğŸ’¡ Funcions Principals**

-   **Comparacions:** Permeten analitzar mÃºltiples variables.
-   **Dades al llarg del temps:** Per detectar tendÃ¨ncies temporals.
-   **Patrons:** IdentificaciÃ³ de tendÃ¨ncies visuals.
-   **Relacions:** AnÃ lisi de correlacions entre variables.

## Avantatges i inconvenients del Heatmap

**âœ… Avantatges**

-   VisiÃ³ clara i rÃ pida de **grans volums de dades**.
-   IdentificaciÃ³ de **tendÃ¨ncies i correlacions**.

**âš ï¸ Inconvenients**

-   DifÃ­cil extreure **valors especÃ­fics**.
-   Els colors poden dificultar la interpretaciÃ³ precisa.
-   Problemes per a persones amb daltonisme.
-   Cal **normalitzar les dades** abans de visualitzar-les.

## ğŸ” Bones PrÃ ctiques del Heatmap

-   Usar **anÃ lisi de clÃºsters** per agrupar valors similars.
-   Triar **paletes de colors adequades** per millorar la interpretaciÃ³.
-   Afegir **dades en brut** dins les celÂ·les si cal una lectura precisa.

**ğŸ“Š Exemples d'AplicaciÃ³**

-   ğŸŒ¡ï¸ **Temperatures:** ComparaciÃ³ de temperatures en diferents ciutats durant l'any.
-   ğŸ“ˆ **Finances:** VisualitzaciÃ³ de volums de compra i venda en mercats financers.
-   ğŸ–¥ï¸ **MÃ rqueting web:** Mapes de calor per veure on els usuaris fan mÃ©s clic.
-   ğŸ¥ **Medicina:** ExpressiÃ³ gÃ¨nica en estudis biomÃ¨dics.

## ğŸ”¥ Heatmap: dades per a realitzar un exemple

- **Font:** [Generalitat de Catalunya](https://administraciodigital.gencat.cat/ca/dades/dades-obertes/informacio-practica/llicencies/)  
- **Departament:** Salut  
- **Nom del conjunt de dades:** Registre de casos de COVID-19 a Catalunya per municipi i sexe  
- **Ãšltima actualitzaciÃ³:** 19 de febrer de 2025  
- **Ã€mbit geogrÃ fic:** Catalunya  
- **Categoria:** Salut  
- **Etiquetes:** COVID-19, coronavirus, SARS-CoV-2, ODS3 (Salut i Benestar)  

ğŸ“Š **AccÃ©s a les dades:**  
[Registre de casos de COVID-19](https://analisi.transparenciacatalunya.cat/Salut/Registre-de-casos-de-COVID-19-a-Catalunya-per-muni/jj6z-iyrp/about_data)  

## ğŸ”¥ Heatmap: dades per a realitzar un exemple

- **DescripciÃ³:**  
  - Recull dades sobre **casos positius** per COVID-19 a Catalunya segons municipi, sexe i tipus de prova.  
  - Les dades inclouen **PCR, TAR, ELISA i test rÃ pid** fins al **26 de juliol de 2022**.  
  - Els casos es basen en la **data dâ€™inici de sÃ­mptomes** i no en la data de la prova.  
  - **No es consideren casos positius** els serolÃ²gics posteriors a la vacunaciÃ³.  
  - **Dades estÃ tiques** (no sâ€™actualitzen).  

ğŸ“Š **AccÃ©s a les dades:**  
[Registre de casos de COVID-19](https://analisi.transparenciacatalunya.cat/Salut/Registre-de-casos-de-COVID-19-a-Catalunya-per-muni/jj6z-iyrp/about_data)  


## ğŸ”¥ Heatmap: grÃ fic d'exemple

```{r heatmap, echo=FALSE, message=FALSE, warning=FALSE}
# Carrego les llibreries necessÃ ries
library(ggplot2)
library(lubridate)
library(dplyr)

# Carrego el CSV
dades <- read.csv("C:/Users/ainap/Documents/Registre_de_casos_de_COVID-19_a_Catalunya_per_municipi_i_sexe_20250402.csv")

# Converteixo la columna 'TipusCasData' a format de data
dades$TipusCasData <- as.Date(dades$TipusCasData, format = "%d/%m/%Y")

# Agrupo per data i tipus de cas, i sumo el nÃºmero de casos
dades_agg <- dades %>%
  group_by(TipusCasData, TipusCasDescripcio) %>%
  summarise(TotalCasos = sum(NumCasos, na.rm = TRUE), .groups = "drop")

# Creo el heatmap
ggplot(dades_agg, aes(x = TipusCasData, y = TipusCasDescripcio, fill = TotalCasos)) +
  geom_tile() +
  scale_fill_gradient(low = "white", high = "blue") +
  labs(title = "Heatmap de Casos per Tipus i Data",
       x = "Data", y = "Tipus de Cas") +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))


```

## ğŸ”¥ Heatmap: conclusions del grÃ fic d'exemple

El heatmap mostra la distribuciÃ³ temporal dels casos de COVID-19 a Catalunya segons el tipus de test utilitzat:

1. **Intensitat i pics de casos**:  
   - Alta incidÃ¨ncia de casos amb pics a finals de 2021 i principis de 2022, especialment per **TAR** i **PCR**.

2. **EvoluciÃ³ en el temps**:  
   - Menor intensitat als primers mesos. L'Ãºs de **TAR** creix respecte a la **PCR** a mesura que passa el temps.

3. **DistribuciÃ³ segons tipus de test**:  
   - **PCR** i **TAR** sÃ³n els mÃ©s utilitzats, mentre que altres mÃ¨todes com **ELISA** tenen menor presÃ¨ncia.


## ğŸŒŸ Radar Chart

-   TambÃ© conegut com: **Web Chart, Spider Chart, Star Chart, Star Plot, Cobweb Chart, GrÃ fic de Red, GrÃ fic Polar i GrÃ fic de Estrella**.
-   Representa dades **multivariants** en un grÃ fic bidimensional.
-   Cada variable tÃ© el seu propi **eix**, i tots parteixen des del mateix punt central.

## ğŸ“œ Com Funciona el Radar Chart?

-   Els grÃ fics radials sÃ³n Ãºtils per **comparar mÃºltiples variables quantitatives**.
-   Permeten veure quines variables tenen **valors similars** o si hi ha **valors atÃ­pics**.
-   Mostren clarament **quÃ¨ variables sÃ³n altes o baixes** dins d'un conjunt de dades.
-   Cada variable tÃ© un **eix propi**, tots disposats radialment i amb **la mateixa escala**.
-   Les lÃ­nies de quadrÃ­cula serveixen com a guia per ajudar a la interpretaciÃ³.
-   Els valors es tracen al llarg del seu **eix individual** i es connecten per formar un **polÃ­gon**.

## âš ï¸ Problemes i Limitacions dels Radar Charts

-   **Massa polÃ­gons** fan el grÃ fic difÃ­cil de llegir i desordenat.
-   Si els polÃ­gons estan plens, poden **tapar informaciÃ³ rellevant**.
-   **Massa variables** creen **massa eixos**, dificultant la interpretaciÃ³.
-   No sÃ³n ideals per **comparar valors especÃ­fics** en cada variable.
-   La interpretaciÃ³ Ã©s menys intuÃ¯tiva que en altres grÃ fics mÃ©s simples.

## âš ï¸ Errors Comuns i Bones PrÃ ctiques\* dels Radar Charts

**ğŸš¨ Errors Comuns**

-   **No incloure mÃ©s de 5 grups en el mateix grÃ fic** â†’ Millor utilitzar facetes.
-   **Evitar escales diferents entre variables** â†’ Si es fan servir, mostrar clarament les escales.

**âœ… Bones PrÃ ctiques**

-   Ãštil per comparar **dades multidimensionals**.
-   MÃ©s efectiu amb un **nombre reduÃ¯t de categories**.
-   Pot ser Ãºtil si es destaquen **patrons generals** en lloc de valors concrets.

## ğŸ“Š Exemples d'AplicaciÃ³ dels Radar Charts

-   ğŸ… **ComparaciÃ³ de rendiment d'esportistes** en diferents categories.
-   ğŸ“ˆ **AvaluaciÃ³ d'indicadors de rendiment** en empreses.
-   ğŸ¥˜ **AnÃ lisi nutricional** de diferents aliments.

**ğŸ” Funcions Principals**

-   **Comparacions** entre mÃºltiples variables.
-   **Relacions** entre els diferents parÃ metres.
-   **Patrons** que ajuden a identificar tendÃ¨ncies.

## ğŸŒŸ Radar Charts: dades per a realitzar un exemple

- **Font:** [Generalitat de Catalunya](https://administraciodigital.gencat.cat/ca/dades/dades-obertes/informacio-practica/llicencies/)  
- **Departament:** Territori, Habitatge i TransiciÃ³ EcolÃ²gica  
- **Nom del conjunt de dades:** EstadÃ­stiques de residus municipals  
- **Ãšltima actualitzaciÃ³:** 20 de febrer de 2025  
- **Ã€mbit geogrÃ fic:** Catalunya  
- **Categoria:** Medi Ambient  
- **Etiquetes:** Residus, recollida selectiva, vidre, orgÃ nica, paper, fracciÃ³ resta, ODS  

ğŸ“Š **AccÃ©s a les dades:**  
[EstadÃ­stiques de residus municipals](https://analisi.transparenciacatalunya.cat/Medi-Ambient/Estad-stiques-de-residus-municipals/69zu-w48s/about_data)  

## ğŸŒŸ Radar Charts: dades per a realitzar un exemple

- **DescripciÃ³:**  
  - Recull estadÃ­stiques de residus municipals a Catalunya.  
  - Inclou quantitats de recollida selectiva per fraccions, totals en termes absoluts i per cÃ pita.  
  - ContÃ© dades sobre la fracciÃ³ resta i el seu destÃ­.  

ğŸ“Š **AccÃ©s a les dades:**  
[EstadÃ­stiques de residus municipals](https://analisi.transparenciacatalunya.cat/Medi-Ambient/Estad-stiques-de-residus-municipals/69zu-w48s/about_data)  


## ğŸŒŸ Radar Charts: grÃ fic d'exemple

```{r radarchart, echo=FALSE, message=FALSE, warning=FALSE}
# Carrego les biblioteques necessÃ ries
library(tidyverse)
library(fmsb)

# Carrego el fitxer CSV
dades <- read.csv("C:/Users/ainap/Documents/Estad_stiques_de_residus_municipals_20250402.csv")

# Selecciono les columnes que ens interessen
dades_seleccionades <- dades %>%
  select(Autocompostatge, MatÃ¨ria.orgÃ nica, Poda.i.jardineria, Paper.i.cartrÃ³, Vidre,
         Envasos.lleugers, Residus.voluminosos...fusta, RAEE, Ferralla, Olis.vegetals, 
         TÃ¨xtil, Runes, Residus.en.Petites.Quantitats..RPQ., Piles, Medicaments,
         Altres.recollides.selectives, Total.Recollida.Selectiva)

# Netejo les dades eliminant les files amb NA
dades_seleccionades_netes <- dades_seleccionades %>%
  drop_na()

# Calculo les mitjanes de les fraccions de residus per fer el radar chart
mitjanes_residus <- colMeans(dades_seleccionades_netes, na.rm = TRUE)

# Afegeixo les mitjanes a un data frame per a la grÃ fica
dades_radar <- as.data.frame(t(mitjanes_residus))

# Afegeixo el nom de les columnes (fraccions de residus) com a noms de les files
colnames(dades_radar) <- colnames(dades_seleccionades)

# Afegeixo una fila de mÃ xims i mÃ­nims per al radar chart
dades_radar <- rbind(rep(100, ncol(dades_radar)), rep(0, ncol(dades_radar)), dades_radar)

# Genero el Radar Chart
radarchart(dades_radar, axistype = 1, 
           pcol = "blue", pfcol = scales::alpha("blue", 0.3), plwd = 4, 
           cglcol = "grey", cglty = 1, axislabcol = "black", caxislabels = seq(0, 100, 20),
           title = "GrÃ fica Radar de Fraccions de Residus")


```

## ğŸŒŸ Radar Charts: conclusions del grÃ fic d'exemple

Aquesta grÃ fica de radar mostra la distribuciÃ³ de diferents fraccions de residus recollits selectivament:

1. **Fraccions mÃ©s destacades**:  
   - **Paper i cartrÃ³**, **vidre** i **envasos lleugers** sÃ³n les mÃ©s recollides, indicant una bona separaciÃ³ en el sistema de recollida.  
   - TambÃ© es destaca l'**autocompostatge** i la **matÃ¨ria orgÃ nica**.

2. **Fraccions menys recollides**:  
   - **Olis vegetals, ferralla, RAEE, piles, medicaments i tÃ¨xtil** tenen valors baixos, possiblement per dificultats en la recollida o manca de consciÃ¨ncia ciutadana.


## ğŸŒŸ Radar Charts: conclusions del grÃ fic d'exemple

3. **DistribuciÃ³ general**:  
   - Alguns pics evidents en determinades fraccions, mentre que d'altres tenen una aportaciÃ³ baixa.  
   - **"Altres recollides selectives"** Ã©s tambÃ© significativa.


## ğŸŒ„ Ridgeline Charts: DefiniciÃ³

-   TambÃ© coneguts com: **Joyplot**.
-   Mostren la **distribuciÃ³** d'un valor numÃ¨ric per a diferents grups.
-   La distribuciÃ³ es representa amb **histogrames** o **grÃ fics de densitat**.
-   Tots els grÃ fics es **solapen lleugerament** en un mateix eix horitzontal.

**ğŸ“œ Com Funciona?**

-   Es colÂ·loquen diverses distribucions **alineades** en un mateix eix.
-   S'utilitza una **superposiciÃ³ parcial** per optimitzar l'espai.
-   Especialment Ãºtil quan hi ha **molts grups** a representar.

## ğŸ¯ Quan Utilitzar un Ridgeline Chart?

-   Quan cal **visualitzar moltes distribucions** sense ocupar massa espai.
-   Quan hi ha **patrons clars** que es poden observar en les dades.
-   Quan es vol destacar l'evoluciÃ³ d'una distribuciÃ³ al llarg del temps.

**âš ï¸ Problemes i Limitacions**

-   **Pot ocultar informaciÃ³** a causa de la superposiciÃ³.
-   **L'elecciÃ³ de la mida dels bins o l'ample de banda** Ã©s crucial per a una correcta interpretaciÃ³.
-   No sempre Ã©s intuÃ¯tiu si els **grups sÃ³n massa similars** o poc diferenciats.

## ğŸ“Š Exemples d'AplicaciÃ³ del Ridgeline Chart

-   ğŸµ **AnÃ lisi de la durada de canÃ§ons** en diferents dÃ¨cades.
-   ğŸ† **DistribuciÃ³ d'estadÃ­stiques esportives** en diferents equips.
-   ğŸ§ª **Mesures experimentals** en diferents condicions de laboratori.

**ğŸš¨ Errors Comuns**

-   **No ajustar correctament la mida dels bins o el bandwidth** â†’ AixÃ² pot afectar la claredat del grÃ fic.
-   **Ãšs inadequat de la superposiciÃ³** â†’ Si no hi ha un patrÃ³ clar, pot dificultar la lectura.


## ğŸŒ„ Ridgeline Charts: dades per a realitzar un exemple

- **Font:** [Generalitat de Catalunya](https://administraciodigital.gencat.cat/ca/dades/dades-obertes/informacio-practica/llicencies/)  
- **Departament:** Economia i Hisenda  
- **Nom del conjunt de dades:** Retribucions del personal funcionari  
- **Ãšltima actualitzaciÃ³:** 19 de febrer de 2025  
- **Ã€mbit geogrÃ fic:** Catalunya  
- **Categoria:** Sector PÃºblic  
- **Etiquetes:** Retribucions, funcionaris, ODS16 (institucions sÃ²lides), ODS5 (igualtat de gÃ¨nere)  

ğŸ“Š **AccÃ©s a les dades:**  
[Retribucions del personal funcionari](https://analisi.transparenciacatalunya.cat/Sector-P-blic/Retribucions-del-personal-funcionari/b4zx-cfga/about_data)  

## ğŸŒ„ Ridgeline Charts: dades per a realitzar un exemple

- **DescripciÃ³:**  
  - Canvis en les retribucions del personal funcionari des de **2007 fins a l'actualitat**.  
  - Inclou grup, nivell, sou base, complements, sou total mensual i anual, i imports de triennis.  
  - **ActualitzaciÃ³ anual.**  

ğŸ“Š **AccÃ©s a les dades:**  
[Retribucions del personal funcionari](https://analisi.transparenciacatalunya.cat/Sector-P-blic/Retribucions-del-personal-funcionari/b4zx-cfga/about_data)  


## ğŸŒ„ Ridgeline Charts: grÃ fic d'exemple

```{r ridgeline_chart, echo=FALSE, message=FALSE, warning=FALSE}
# Carrego les biblioteques necessÃ ries
library(ggplot2)
library(ggridges)
library(dplyr)

# Carrego el CSV
dades <- read.csv("C:/Users/ainap/Documents/Retribucions_del_personal_funcionari_20250402.csv")

# Selecciono una variable contÃ­nua (com Sou) i una variable categÃ²rica (com GRUP)
dades_ridgeline <- dades %>% 
  select(Sou, GRUP) %>%
  filter(!is.na(Sou))  # Eliminar els valors NA per a Sou

# Creo el Ridgeline Chart
ggplot(dades_ridgeline, aes(x = Sou, y = GRUP, fill = GRUP)) +
  geom_density_ridges(alpha = 0.7) +
  theme_ridges() +
  labs(title = "DistribuciÃ³ del Sou per GRUP",
       x = "Sou",
       y = "GRUP") +
  theme(legend.position = "none")


```

## ğŸŒ„ Ridgeline Charts: conclusions del grÃ fic d'exemple

Aquesta grÃ fica mostra la distribuciÃ³ del sou per diferents grups (C2, C1, AP, A2 i A1):

1. **C2 i C1**:  
   - Sous mÃ©s baixos, concentrats entre **500 i 700** euros.  

2. **AP (AdministraciÃ³ PÃºblica?)**:  
   - DistribuciÃ³ mÃ©s Ã mplia, amb un pic a **900-1000** euros, indicant diversitat salarial.

3. **A2 i A1**:  
   - **A2** tÃ© un pic a **1000** euros, perÃ² amb mÃ©s dispersiÃ³.  
   - **A1** destaca amb sous superiors a **1200** euros i mÃ©s variabilitat.

